Das Storage System in Open WebUI funktioniert so, dass Chat-Daten und Datei-Uploads getrennt verwaltet werden.

Chat-LÃ¶schung vs. Datei-Persistierung
Wenn Sie eine Session/Chat im Interface lÃ¶schen, werden nur die Chat-Metadaten und Nachrichten entfernt, aber hochgeladene Dateien bleiben im System bestehen. chats.py:908-926

Die Chat-LÃ¶schung erfolgt Ã¼ber die delete_chat_by_id_and_user_id Funktion, die nur Chat-EintrÃ¤ge aus der Datenbank entfernt: chats.py:918-926

Datei-Storage System
Das Problem, das Sie beschreiben, ist ein bekanntes Issue. Laut dem Changelog wurde dies bereits adressiert: CHANGELOG.md:44

Die LÃ¶sung implementiert eine Bereinigung, bei der beim LÃ¶schen von Dateien auch die zugehÃ¶rigen Vektordaten entfernt werden. Dies verhindert, dass "verwaiste" Dateien im System verbleiben.

API-Endpunkt /api/v1/files
Der /api/v1/files Endpunkt zeigt alle im System gespeicherten Dateien an, unabhÃ¤ngig davon, ob die zugehÃ¶rigen Chats noch existieren. Dies ist das erwartete Verhalten, da Dateien mÃ¶glicherweise in mehreren Chats verwendet werden kÃ¶nnen.

Archivierung vs. LÃ¶schung
Das System unterscheidet zwischen Archivierung und vollstÃ¤ndiger LÃ¶schung: index.ts:772-802

Archivierte Chats kÃ¶nnen Ã¼ber eine separate Modal-Ansicht verwaltet werden: ArchivedChatsModal.svelte:1-60

Notes

Das Storage System ist so konzipiert, dass Dateien persistent bleiben, um Datenverlust zu vermeiden. Wenn Sie mÃ¶chten, dass Dateien beim Chat-LÃ¶schen automatisch entfernt werden, mÃ¼ssten Sie dies Ã¼ber die Admin-Einstellungen oder direkt Ã¼ber die API verwalten. 


Das sagt Chat GPT noch dazu:

Wie funktioniert das Storage-System von Open WebUI?
Speicherung von Chats und Dateien
Chat-Inhalte (Nachrichten, Metadaten etc.) werden in einer relationalen Datenbank gespeichert (standardmÃ¤ÃŸig SQLite, alternativ via ENV konfigurierbar) â€“ z.â€¯B. in /app/backend/data/webui.db ğŸ“ 


Dateien (PDFs, Bilder etc.) werden physisch auf dem Filesystem oder in einem Storage-Provider (z.â€¯B. Local, S3) abgelegt â€“ beispielsweise unter einem Upload-Verzeichnis im Container. Die Zuordnung erfolgt Ã¼ber Tabellen und Vector DB 


Chat lÃ¶schen â‰  Datei lÃ¶schen
Erwartetes Verhalten vs. RealitÃ¤t
In der BenutzeroberflÃ¤che fÃ¼hrt das LÃ¶schen eines Chats nicht automatisch zum LÃ¶schen der darin hochgeladenen Dateien.

Chats selbst werden entfernt (ein Datensatz pro Chat in der DB), jedoch verwaiste Dateien bleiben erhalten â€“ sie sind weiterhin Ã¼ber API-Endpunkte wie /api/v1/files sichtbar und persistiert. Das ist derzeit Standardverhalten, keine Konfigurationsoption zum automatischen DateienÂ­lÃ¶schen vorhanden. 

Bekanntes Issue:
In der GitHubâ€‘Diskussion #8875 wurde ein Feature-Request gestellt: Automatische SÃ¤uberung nicht mehr referenzierter Dateien nach Chat-LÃ¶schung mittels Hintergrundjob

Nutze API-Endpunkte wie DELETE /api/v1/files/{id} oder DELETE /api/v1/files/all (Admin), um nicht mehr benÃ¶tigte Dateien zu entfernen